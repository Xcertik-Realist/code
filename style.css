# style.css

/* Reset & Basics */
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family: system-ui, sans-serif; line-height:1.6; color:#333; background:#fafafa; }
a { color:inherit; text-decoration:none; }
img { max-width:100%; display:block; }
.container { max-width:1200px; margin:auto; padding:0 1rem; }
.visually-hidden { position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0; }

/* Layout */
header, footer { background:#222; color:#fff; }
header .header-flex { display:flex; justify-content:space-between; align-items:center; padding:1rem 0; }
.logo { font-size:1.5rem; font-weight:bold; }
nav a { margin-left:1.5rem; color:#fff; }

.hero { background:linear-gradient(rgba(0,0,0,.4),rgba(0,0,0,.4)), url('https://images.unsplash.com/photo-1507009973206-3f7a43993adb?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80') center/cover; color:#fff; text-align:center; padding:4rem 0; }
.hero h2 { font-size:2.5rem; margin-bottom:.5rem; }

.grid { display:grid; grid-template-columns:repeat(3,1fr); gap:1.5rem; margin:2rem 0; }
.card { background:#fff; border-radius:8px; overflow:hidden; box-shadow:0 2px 8px rgba(0,0,0,.1); cursor:pointer; transition:transform .2s; }
.card:hover { transform:translateY(-4px); }
.card img { height:200px; object-fit:cover; }
.card .info { padding:1rem; }
.card h3 { font-size:1.1rem; margin-bottom:.3rem; }
.card p { font-size:.9rem; color:#666; }

footer { text-align:center; padding:1.5rem 0; font-size:.9rem; }

/* Modal */
.modal { display:none; position:fixed; inset:0; background:rgba(0,0,0,.7); align-items:center; justify-content:center; z-index:1000; }
.modal-content { background:#fff; max-width:900px; width:90%; max-height:90vh; overflow:auto; border-radius:8px; position:relative; }
.close { position:absolute; top:1rem; right:1rem; font-size:2rem; cursor:pointer; color:#aaa; background:none; border:none; }
.modal-body { display:grid; grid-template-columns:1fr 1fr; gap:1rem; padding:2rem; }
.large-img img { width:100%; border-radius:6px; }
.thumbs { display:flex; gap:.5rem; margin-top:.5rem; }
.thumbs img { width:70px; height:70px; object-fit:cover; border-radius:4px; cursor:pointer; opacity:.7; transition:opacity .2s; }
.thumbs img.active { opacity:1; border:2px solid #222; }
.details h3 { margin-bottom:.5rem; }
.price { font-weight:bold; color:#d32; font-size:1.2rem; }
.buy-btn { background:#222; color:#fff; border:none; padding:.6rem 1.2rem; margin-top:1rem; border-radius:4px; cursor:pointer; }

/* Forms */
.page { padding:2rem 0; }
label { display:block; margin-bottom:.5rem; }
input, textarea, button { width:100%; padding:.6rem; margin-bottom:1rem; border:1px solid #ccc; border-radius:4px; }
button { background:#222; color:#fff; cursor:pointer; }
button[type="submit"] { width:auto; display:inline-block; }

/* Responsive */
@media (max-width:900px) { .grid { grid-template-columns:repeat(2,1fr); } .modal-body { grid-template-columns:1fr; } }
@media (max-width:600px) { .grid { grid-template-columns:1fr; } }
EOF

# main.js
cat > js/main.js << 'EOF'
const STORAGE_KEY = 'minishop_products';
const getProducts = () => JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
const saveProducts = (arr) => localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));

const defaultProducts = [/* 9 products – same as before */];
if (getProducts().length === 0) saveProducts(defaultProducts);

const gridEl = document.getElementById('product-grid');
function renderGrid() {
  const products = getProducts();
  gridEl.innerHTML = '';
  const homeSchema = { "@context": "https://schema.org", "@type": "WebSite", "name": "MiniShop", "url": window.location.origin };
  document.getElementById('jsonld-home').textContent = JSON.stringify(homeSchema);

  products.forEach(p => {
    const card = document.createElement('article');
    card.className = 'card';
    card.setAttribute('itemscope', '');
    card.setAttribute('itemtype', 'https://schema.org/Product');
    card.dataset.id = p.id;

    card.innerHTML = `
      <a href="#${p.id}" aria-label="View ${p.title}">
        <img src="${p.images[0]}" alt="${p.title}" loading="lazy" itemprop="image">
      </a>
      <div class="info">
        <h3 itemprop="name"><a href="#${p.id}">${p.title}</a></h3>
        <p itemprop="description">${p.short}</p>
        <p class="price" itemprop="offers" itemscope itemtype="https://schema.org/Offer">
          <meta itemprop="priceCurrency" content="CHF">
          <span itemprop="price">${p.price.toFixed(2)}</span> CHF
          <link itemprop="availability" href="https://schema.org/InStock">
        </p>
      </div>
    `;

    const script = document.createElement('script');
    script.type = "application/ld+json";
    script.textContent = JSON.stringify({
      "@context": "https://schema.org", "@type": "Product",
      "name": p.title, "image": p.images, "description": p.detail,
      "sku": p.id, "brand": { "@type": "Brand", "name": "MiniShop" },
      "offers": { "@type": "Offer", "priceCurrency": "CHF", "price": p.price, "availability": "https://schema.org/InStock", "url": `${window.location.origin}/#${p.id}` }
    });
    card.appendChild(script);

    card.addEventListener('click', () => openModal(p));
    gridEl.appendChild(card);
  });
}

function openModal(p) {
  document.getElementById('modal-main-img').src = p.images[0];
  document.getElementById('modal-product-title').textContent = p.title;
  document.getElementById('modal-desc').textContent = p.detail;
  document.getElementById('modal-price').innerHTML = `<meta itemprop="priceCurrency" content="CHF"><span itemprop="price">${p.price.toFixed(2)}</span> CHF`;

  const thumbs = document.querySelector('.thumbs');
  thumbs.innerHTML = '';
  p.images.forEach((src, i) => {
    const img = document.createElement('img');
    img.src = src; img.alt = `thumb ${i+1}`;
    if (i===0) img.classList.add('active');
    img.addEventListener('click', () => {
      document.getElementById('modal-main-img').src = src;
      document.querySelectorAll('.thumbs img').forEach(t => t.classList.remove('active'));
      img.classList.add('active');
    });
    thumbs.appendChild(img);
  });

  document.getElementById('modal').style.display = 'flex';
}

document.querySelector('.close').onclick = () => document.getElementById('modal').style.display = 'none';
window.onclick = e => { if (e.target === document.getElementById('modal')) document.getElementById('modal').style.display = 'none'; };

document.getElementById('year').textContent = new Date().getFullYear();
renderGrid();
EOF

# admin.js
cat > js/admin.js << 'EOF'
const STORAGE_KEY = 'minishop_products';
const getProducts = () => JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
const saveProducts = (arr) => localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));

const form = document.getElementById('upload-form');
const listEl = document.getElementById('admin-list');

form.addEventListener('submit', async e => {
  e.preventDefault();
  const title = document.getElementById('title').value.trim();
  const short = document.getElementById('short').value.trim();
  const detail = document.getElementById('detail').value.trim();
  const price = parseFloat(document.getElementById('price').value);
  const mainFile = document.getElementById('main-img').files[0];
  const thumbFiles = Array.from(document.querySelectorAll('input[id^="thumb-"]')).map(i => i.files[0]).filter(Boolean);

  if (!mainFile) return alert('Main image required');

  const toDataURL = file => new Promise((res, rej) => {
    const reader = new FileReader();
    reader.onload = () => res(reader.result);
    reader.onerror = rej;
    reader.readAsDataURL(file);
  });

  const mainURL = await toDataURL(mainFile);
  const thumbURLs = await Promise.all(thumbFiles.map(toDataURL));
  const images = [mainURL, ...thumbURLs];

  const newProduct = { id: Date.now().toString(), title, short, detail, price, images };
  const products = getProducts();
  products.push(newProduct);
  saveProducts(products);
  alert('Product uploaded!');
  form.reset();
  renderAdminList();
});

function renderAdminList() {
  const products = getProducts();
  listEl.innerHTML = '';
  products.forEach(p => {
    const li = document.createElement('li');
    li.textContent = `${p.title} – CHF ${p.price.toFixed(2)} (${p.images.length} images)`;
    const del = document.createElement('button');
    del.textContent = 'Delete'; del.style.marginLeft = '1rem';
    del.onclick = () => {
      if (confirm('Delete?')) {
        saveProducts(products.filter(x => x.id !== p.id));
        renderAdminList();
      }
    };
    li.appendChild(del);
    listEl.appendChild(li);
  });
}
renderAdminList();
document.getElementById('year').textContent = new Date().getFullYear();



